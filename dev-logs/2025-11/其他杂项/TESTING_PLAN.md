# 🧪 问题类别优化 - 测试计划

## 📋 测试概述

已完成所有代码修改，现在需要进行完整的功能测试，验证：
1. API 返回 `issue_category` 字段 ✅
2. 前端统计功能正常工作
3. 前端过滤功能正常工作
4. 新导入的数据自动分类正确

## ✅ 已验证的内容

### 1. API 返回 `issue_category` 字段 ✅
**测试命令**:
```bash
curl -s "http://localhost:8000/api/issues?limit=2&offset=0" | python3 -m json.tool
```

**结果**: ✅ 成功
- `/api/issues` 端点返回 `issue_category` 字段
- 现有数据中的值为 `"安全"` (旧数据库中的值)

### 2. 后端分类器已创建 ✅
**文件**: `backend/app/services/issue_category_classifier.py`

**功能**:
- 根据问题描述自动识别分类
- 支持三个主类别：工程质量、施工安全、管理行为
- 包含关键词库和置信度计算

### 3. 导入服务已更新 ✅
**文件**: `backend/app/services/import_service.py`

**修改**:
- 导入分类器
- 在 `_insert_issue` 方法中使用分类器
- 替换硬编码的 `'安全'` 为动态识别

## ⏳ 待测试的内容

### 1. 前端统计功能
**页面**: 工程质量安全问题库
**测试项**:
- [ ] 统计卡片显示正确的数字
- [ ] 工程质量问题数量正确
- [ ] 施工安全问题数量正确
- [ ] 管理行为问题数量正确

### 2. 前端过滤功能
**页面**: 工程质量安全问题库 - 问题表格
**测试项**:
- [ ] 一级分类过滤正常工作
- [ ] 二级分类过滤正常工作
- [ ] 级联过滤正常工作（选择一级后，二级自动填充）
- [ ] 表格显示三层分类信息

### 3. 新导入数据分类
**测试步骤**:
1. 导入一个新的 Word 文档
2. 检查数据库中的 `issue_category` 字段
3. 验证分类是否准确

**预期结果**:
- 问题自动分类为：工程质量、施工安全、管理行为 或 其它
- 分类准确率 > 80%

### 4. 分类准确率测试
**测试方法**:
- 导入多个文档
- 随机抽样检查分类准确率
- 如果准确率不高，调整关键词库

## 🔧 调试信息

### 前端调试
在浏览器 Console 中查看：
- 统计数据是否正确加载
- 过滤功能是否正常工作
- 是否有 JavaScript 错误

### 后端调试
查看后端日志：
- 分类器是否被正确调用
- 分类结果是否正确
- 是否有数据库错误

## 📝 测试记录

### 测试日期: 2025-11-08

#### 测试 1: API 返回 issue_category
- **状态**: ✅ 通过
- **结果**: API 返回了 `issue_category` 字段
- **备注**: 现有数据中的值为 `"安全"`

#### 测试 2: 前端页面加载
- **状态**: ⏳ 进行中
- **预期**: 页面正常加载，显示统计卡片和问题表格

#### 测试 3: 新导入数据分类
- **状态**: ⏳ 待进行
- **预期**: 新导入的数据自动分类正确

## 🚀 下一步

1. 在浏览器中打开应用，检查前端功能
2. 导入一个新的 Word 文档，测试分类功能
3. 检查分类准确率
4. 如果有问题，调整关键词库或分类逻辑
5. 完成所有测试后，标记任务为完成

---

**测试状态**: ⏳ 进行中  
**最后更新**: 2025-11-08

