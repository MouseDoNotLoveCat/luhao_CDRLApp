# 项目与标段管理 - 快速开始指南

**版本**: 1.0  
**日期**: 2025-11-07

---

## 🚀 快速开始

### 1. 启动应用

```bash
# 终端 1: 启动后端
cd backend
python -m uvicorn app.main:app --reload --port 8000

# 终端 2: 启动前端
cd frontend
npm run dev
```

### 2. 访问应用

打开浏览器访问: **http://localhost:3000**

### 3. 导航到项目管理

点击左侧菜单中的 **"项目与标段管理"** 菜单项

---

## 📋 功能使用

### 项目管理

#### 查看项目列表
- 进入项目管理页面后，默认显示项目列表
- 显示所有项目的名称、建设单位、标段数量

#### 搜索项目
- 在搜索框中输入项目名称或建设单位
- 实时搜索，自动过滤结果

#### 创建新项目
```
1. 点击 "➕ 新建项目" 按钮
2. 在弹出的表单中填写：
   - 项目名称 (必填)
   - 建设单位 (可选)
3. 点击 "创建" 按钮
4. 成功后自动刷新列表
```

#### 编辑项目
```
1. 在项目列表中找到要编辑的项目
2. 点击该行的 "编辑" 按钮
3. 在弹出的表单中修改信息
4. 点击 "更新" 按钮
5. 成功后自动刷新列表
```

#### 删除项目
```
1. 在项目列表中找到要删除的项目
2. 点击该行的 "删除" 按钮
3. 在确认对话框中点击 "确定"
4. 如果项目下有标段，会提示是否级联删除
5. 成功后自动刷新列表
```

#### 查看项目的标段
```
1. 在项目列表中找到要查看的项目
2. 点击该行的 "查看标段" 按钮
3. 进入标段列表页面
```

---

### 标段管理

#### 查看标段列表
- 点击项目的 "查看标段" 按钮后进入标段列表
- 显示该项目下所有标段的详细信息
- 顶部显示项目基本信息卡片

#### 搜索标段
- 在搜索框中输入标段编号、名称或单位名称
- 实时搜索，自动过滤结果

#### 创建新标段
```
1. 点击 "➕ 新建标段" 按钮
2. 在弹出的表单中填写：
   - 标段编号 (必填)
   - 标段名称 (可选)
   - 施工单位 (可选)
   - 监理单位 (可选)
   - 设计单位 (可选)
   - 第三方检测单位 (可选)
3. 点击 "创建" 按钮
4. 成功后自动刷新列表
```

#### 编辑标段
```
1. 在标段列表中找到要编辑的标段
2. 点击该行的 "编辑" 按钮
3. 在弹出的表单中修改信息
4. 点击 "更新" 按钮
5. 成功后自动刷新列表
```

#### 删除标段
```
1. 在标段列表中找到要删除的标段
2. 点击该行的 "删除" 按钮
3. 在确认对话框中点击 "确定"
4. 成功后自动刷新列表
```

#### 返回项目列表
- 点击页面顶部的 "← 返回项目列表" 按钮
- 或点击面包屑导航中的项目名称

---

## 🔍 常见操作

### 批量导入项目和标段

虽然当前界面不支持直接批量导入，但可以通过以下方式：

1. **使用 API 直接导入**
   ```bash
   # 创建项目
   curl -X POST "http://localhost:8000/api/projects" \
     -H "Content-Type: application/json" \
     -d '{"project_name": "新项目", "builder_unit": "建设单位"}'
   
   # 创建标段
   curl -X POST "http://localhost:8000/api/sections" \
     -H "Content-Type: application/json" \
     -d '{"project_id": 1, "section_code": "QFSG-1", ...}'
   ```

2. **使用测试脚本**
   ```bash
   cd backend
   python scripts/test_project_management_api.py
   ```

### 数据备份

项目和标段数据存储在 SQLite 数据库中：
```bash
# 数据库位置
backend/cdrl.db

# 备份数据库
cp backend/cdrl.db backend/cdrl.db.backup
```

---

## ⚠️ 注意事项

### 数据唯一性
- **项目名称**: 全局唯一，不能重复
- **标段编号**: 同一项目下唯一，不同项目可以有相同的标段编号

### 级联删除
- 删除项目时，如果项目下有标段，需要确认是否级联删除
- 级联删除会同时删除项目和其下所有标段

### 搜索功能
- 搜索是模糊匹配，支持部分关键词搜索
- 搜索不区分大小写

### 分页
- 默认每页显示 20 条记录
- 可以在分页控件中修改每页显示数量

---

## 🐛 故障排除

### 问题: 无法连接到后端 API

**解决方案**:
1. 确保后端已启动: `python -m uvicorn app.main:app --reload --port 8000`
2. 检查后端是否运行在 http://localhost:8000
3. 检查浏览器控制台是否有 CORS 错误

### 问题: 创建项目时提示"项目名称已存在"

**解决方案**:
1. 项目名称必须唯一
2. 修改项目名称，添加时间戳或其他标识符
3. 例如: "新项目_20251107"

### 问题: 删除项目时提示"项目下有标段"

**解决方案**:
1. 在删除确认对话框中选择"级联删除"
2. 或先手动删除项目下的所有标段，再删除项目

---

## 📞 获取帮助

- 查看完整文档: [项目管理实现文档](../features/PROJECT_MANAGEMENT_IMPLEMENTATION.md)
- 查看 API 参考: [API 参考文档](./PROJECT_MANAGEMENT_API_REFERENCE.md)
- 查看测试指南: [测试指南](../testing/PROJECT_MANAGEMENT_TEST_GUIDE.md)

---

**最后更新**: 2025-11-07


