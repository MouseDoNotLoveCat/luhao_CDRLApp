# 导入功能测试计划

## 测试环境准备

### 后端启动
```bash
cd backend
python -m uvicorn app.main:app --reload --host 0.0.0.0 --port 8000
```

### 前端启动
```bash
cd frontend
npm run dev
```

## 测试用例

### 1. 文件识别测试

#### 1.1 单文件识别
- **步骤**：
  1. 打开导入页面
  2. 选择一个 .docx 文件
  3. 点击"导入文件"按钮
  
- **预期结果**：
  - 显示"正在识别文件..."进度条
  - 识别完成后显示"已识别的通知书"预览界面
  - 显示通知书编号、检查日期、检查单位、问题数量

#### 1.2 识别失败处理
- **步骤**：
  1. 选择一个格式错误的 .docx 文件
  2. 点击"导入文件"按钮
  
- **预期结果**：
  - 显示错误提示信息
  - 返回到上传界面

### 2. 通知书预览测试

#### 2.1 通知书选择
- **步骤**：
  1. 识别文件后进入预览界面
  2. 勾选通知书复选框
  3. 点击"下一步"按钮
  
- **预期结果**：
  - 复选框状态正确更新
  - 显示已选择的通知书数量
  - 进入问题预览界面

#### 2.2 通知书移除
- **步骤**：
  1. 在预览界面点击"移除"按钮
  
- **预期结果**：
  - 通知书从列表中移除
  - 如果没有通知书，返回上传界面

### 3. 问题预览测试

#### 3.1 问题选择
- **步骤**：
  1. 进入问题预览界面
  2. 勾选问题复选框
  3. 查看统计信息
  
- **预期结果**：
  - 复选框状态正确更新
  - 统计信息实时更新
  - 显示已选择的问题数量

#### 3.2 快速选择
- **步骤**：
  1. 点击"全选/全不选"按钮
  2. 点击"选择下发整改通知单"按钮
  3. 点击"选择其他问题"按钮
  
- **预期结果**：
  - 相应的问题被选中/取消选中
  - 统计信息正确更新

### 4. 导入确认测试

#### 4.1 确认导入
- **步骤**：
  1. 选择问题后点击"下一步"
  2. 查看导入摘要
  3. 点击"确认导入"按钮
  
- **预期结果**：
  - 显示导入摘要信息
  - 显示选中的问题列表
  - 显示"正在导入..."进度条

#### 4.2 返回修改
- **步骤**：
  1. 在确认界面点击"返回修改"按钮
  
- **预期结果**：
  - 返回到问题预览界面
  - 之前的选择状态保留

### 5. 导入结果测试

#### 5.1 导入成功
- **步骤**：
  1. 完成导入流程
  
- **预期结果**：
  - 显示"导入完成"提示
  - 显示导入的通知书编号和问题数量
  - 显示导入的问题列表

#### 5.2 导入失败
- **步骤**：
  1. 导入重复的通知书编号
  
- **预期结果**：
  - 显示错误提示信息
  - 显示"返回导入"和"查看通知书列表"按钮

### 6. 数据库验证

#### 6.1 验证通知书数据
```sql
SELECT * FROM supervision_notices WHERE notice_number = '...';
```

#### 6.2 验证问题数据
```sql
SELECT * FROM issues WHERE supervision_notice_id = ...;
```

## 测试检查清单

- [ ] 文件识别功能正常工作
- [ ] 通知书预览界面显示正确
- [ ] 问题预览界面显示正确
- [ ] 选择功能正常工作
- [ ] 导入确认界面显示正确
- [ ] 导入结果显示正确
- [ ] 数据库中的数据正确
- [ ] 错误处理正常工作
- [ ] 返回和取消功能正常工作
- [ ] 性能满足要求（<100ms 响应时间）

## 已知问题和限制

- 当前仅支持单文件识别（批量识别需要后续实现）
- 识别结果缓存在前端，刷新页面会丢失
- 不支持识别结果的编辑功能（可作为后续优化）

## 后续优化

1. 支持批量文件识别
2. 添加识别结果的编辑功能
3. 添加数据验证和冲突检测
4. 支持识别结果的导出和导入
5. 添加识别历史记录

